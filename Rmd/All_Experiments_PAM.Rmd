---
title: "Untitled"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# LOAD LIBRARIES # 
```{r}
library(lmerTest)
library(emmeans)
library(sjPlot)
library(drc)
library(car)
library(Rmisc)
library(ggplot2)
library(tidyr)
library(dplyr)
library(plyr)
library(reshape2)
library(data.table)
```

# IMPORT DATA #
```{r}
IPa <- readxl::read_xlsx("data/PAM/2021-06-08_Past-4temps-Inshore.xlsx")

OPa <- readxl::read_xlsx("data/PAM/2021-06-10_Past-4temps-Offshore.xlsx") %>%
  select(-Temp)

NAc <- readxl::read_xlsx("data/PAM/2021-06-11_Acer-4temps-MoteLooeNursery_Run2.xlsx") %>%
  mutate(TagNumber = Genotype,
         Comments = Comment) %>%
  select(-Comment)

# Combine all Datasets 
Allpam <- rbind(IPa, OPa, NAc) %>%
  mutate(Species = case_when(Species == "Acropora cervicornis" ~ "ACER",
                             Species == "Porites astreoides" ~ "PAST")) %>%
  select(TubeNumber, sample_ID = SampleName, species = Species, Geno = Genotype, Treatment, Temperature = Temp_Setpoint, Timepoint, FvFm = PAM) %>%
  mutate(TP_ID = case_when(grepl("T1", sample_ID) ~ "T1",
                           grepl("T2", sample_ID) ~ "T2",
                           grepl("T3", sample_ID) ~ "T3",
                           grepl("T4", sample_ID) ~ "T4",
                           grepl("T5", sample_ID) ~ "T5",
                           grepl("T0", sample_ID) ~ "T0",
                           grepl("TF", sample_ID) ~ "TF"))


Allpam$FacTemp<-as.factor(Allpam$Temperature)
Allpam$Geno<-as.factor(Allpam$Geno)
Allpam$Temperature<- as.integer(Allpam$Temperature)
Allpam<-as.data.frame(Allpam)

PAST <- Allpam %>%
  filter(species == "PAST") 

ACER <- Allpam %>%
  filter(species == "ACER") %>%
  mutate(Geno = case_when(Geno == "07" ~ "07",
                          Geno == "31.0" ~ "31",
                          Geno == "34.0" ~ "34",
                          Geno == "41.0" ~ "41",
                          Geno == "48.0" ~ "48",
                          Geno == "50.0" ~ "50",
                          Geno == "62.0" ~ "62",
                          Geno == "CM5" ~ "CM5"))
```

# PAST ED50s PER GENO PER TIMEPOINT #
```{r}
Past_TP <- PAST %>%
  filter(TP_ID == "T1" | TP_ID == "T2" | TP_ID == "T3" | TP_ID == "T4" & Timepoint == "T4" | TP_ID == "T5" & Timepoint == "T5") %>%
  mutate(ID = paste(Geno,TP_ID))

Past_TP_DRC <- drm(FvFm ~ Temperature, data = Past_TP, curveid = ID,
             fct = LL.3(names = c('hill', 'max', 'ed50')))

summary(Past_TP_DRC)
compParm(Past_TP_DRC, 'ed50')
compParm(Past_TP_DRC, 'ed50', "-")
plot(Past_TP_DRC)

Past_TP_ED <- ED(Past_TP_DRC, c(50), interval = "delta")

Past_ED_df <- as.data.frame(Past_TP_ED) %>%
  setDT(keep.rownames = "Geno") %>%
  mutate(Genotype = case_when(grepl(":01", Geno) ~ "01",
                              grepl(":02", Geno) ~ "02",
                              grepl(":03", Geno) ~ "03",
                              grepl(":04", Geno) ~ "04",
                              grepl(":05", Geno) ~ "05",
                              grepl(":06", Geno) ~ "06",
                              grepl(":07", Geno) ~ "07",
                              grepl(":08", Geno) ~ "08",
                              grepl(":09", Geno) ~ "09",
                              grepl(":10", Geno) ~ "10")) %>%
  mutate(TP_ID = case_when(grepl("T1", Geno)~ "T1",
                           grepl("T2", Geno)~ "T2",
                           grepl("T3", Geno)~ "T3",
                           grepl("T4", Geno)~ "T4",
                           grepl("T5", Geno)~ "T5")) %>%
select(-Geno, ED50 = Estimate) %>%
  mutate(site = case_when(Genotype == "01" | Genotype == "02" | Genotype == "03" | 
                            Genotype == "04" | Genotype == "05" ~ "offshore",
                          Genotype == "06" | Genotype == "07" | Genotype == "08" | 
                            Genotype == "09" | Genotype == "10" ~ "inshore"))

Past_ED50_TP <- Past_ED_df %>%
  select(Genotype, TP_ID, site, ED50)

Genotype <- Past_ED50_TP$Genotype

ggplot(Past_ED50_TP, aes(x = TP_ID, y = ED50, color = Genotype)) +
  geom_point() +
  ggrepel::geom_text_repel(label= Genotype, nudge_x = 0.25) +
  facet_wrap(~site) +
  theme_bw() +
  theme(legend.position = "none") +
  ggtitle("P.ast ED50s: all Timepoints")

ggsave(filename = "plots/Past_Rank_ED50_all_TP_genofits.png", width = 174, height = 100, units = "mm")

  
geno_ED50s_TP <- Past_ED50_TP %>%
  spread(key = TP_ID, value = ED50) %>%
  group_by(Genotype) %>%
  mutate(avgfit = mean(c(T1, T2, T3, T4, T5)),
         min = min(c(T1, T2, T3, T4, T5)),
         max = max(c(T1, T2, T3, T4, T5)),
         diff = max - min) 

library("writexl")
geno_ED50s_TP %>%
  write_xlsx("ED50/Past_all_TPs_Genets_ED50.xlsx")

```

# PAST ED50S PER GENO PER T3 SAMPLING TIMEPOINT (T3, T4, & T5 SAMPLES FROM T3) #
```{r}
T3_Past <- PAST %>%
  filter(Timepoint == "T3")%>%
  mutate(ID = paste(Geno,TP_ID))

Past_T3_DRC <- drm(FvFm ~ Temperature, data = T3_Past, curveid = ID,
             fct = LL.3(names = c('hill', 'max', 'ed50')))

summary(Past_T3_DRC)
compParm(Past_T3_DRC, 'ed50')
compParm(Past_T3_DRC, 'ed50', "-")
plot(Past_T3_DRC)

Past_T3_ED <- ED(Past_T3_DRC, c(50), interval = "delta")

Past_T3_ED_df <- as.data.frame(Past_T3_ED) %>%
  setDT(keep.rownames = "Geno") %>%
  mutate(Genotype = case_when(grepl(":01", Geno) ~ "01",
                              grepl(":02", Geno) ~ "02",
                              grepl(":03", Geno) ~ "03",
                              grepl(":04", Geno) ~ "04",
                              grepl(":05", Geno) ~ "05",
                              grepl(":06", Geno) ~ "06",
                              grepl(":07", Geno) ~ "07",
                              grepl(":08", Geno) ~ "08",
                              grepl(":09", Geno) ~ "09",
                              grepl(":10", Geno) ~ "10")) %>%
  mutate(TP_ID = case_when(grepl("T3", Geno)~ "T3",
                           grepl("T4", Geno)~ "T4",
                           grepl("T5", Geno)~ "T5")) %>%
select(-Geno, ED50 = Estimate) %>%
  mutate(site = case_when(Genotype == "01" | Genotype == "02" | Genotype == "03" | 
                            Genotype == "04" | Genotype == "05" ~ "offshore",
                          Genotype == "06" | Genotype == "07" | Genotype == "08" | 
                            Genotype == "09" | Genotype == "10" ~ "inshore"))

Past_ED50_T3 <- Past_T3_ED_df %>%
  select(Genotype, TP_ID, site, ED50) %>%
  filter(ED50 < 50) # Geno 08 T4 sample is very high 

Genotype_T3 <- Past_ED50_T3$Genotype

ggplot(Past_ED50_T3, aes(x = TP_ID, y = ED50, color = Genotype)) +
  geom_point() +
  ggrepel::geom_text_repel(label= Genotype_T3, nudge_x = 0.25) +
  facet_wrap(~site) +
  theme_bw() +
  theme(legend.position = "none") +
  ggtitle("P.ast ED50s: T3 Sampling Timepoint")

ggsave(filename = "plots/Past_Rank_ED50_all_TP_genofits.png", width = 174, height = 100, units = "mm")

  
geno_ED50s_T3 <- Past_ED50_T3 %>%
  spread(key = TP_ID, value = ED50) %>%
  group_by(Genotype) %>%
  mutate(avgfit = mean(c(T3, T4, T5)),
         min = min(c(T3, T4, T5)),
         max = max(c(T3, T4, T5)),
         diff = max - min) 

library("writexl")
geno_ED50s_T3 %>%
  write_xlsx("ED50/Past_T3_Genets_ED50.xlsx")

```

# PAST PAM MEASUREMENT PLOTTING #
```{r}
Past_PAM_TP <-  PAST %>%
  filter(TubeNumber != "NA") %>%
  select(Genotype = Geno, Treatment, Temperature, TP_ID, FvFm) %>%
  filter(Treatment != "Field", 
         Treatment != "Initial") %>%
  mutate(site = case_when(Genotype == "01" | Genotype == "02" | Genotype == "03" | 
                            Genotype == "04" | Genotype == "05" ~ "offshore",
                          Genotype == "06" | Genotype == "07" | Genotype == "08" | 
                            Genotype == "09" | Genotype == "10.0" ~ "inshore"))

# Inshore Genotypes #
inshore <- Past_PAM_TP %>%
  filter(site == "inshore")

inshore_geno <- inshore$Genotype

inshore$Treatment_f = factor(inshore$Treatment, levels=c('Control','Low','Medium','High'))

ggplot(inshore, aes(x = TP_ID, y = FvFm, color = Genotype)) +
  geom_point() +
  ggrepel::geom_text_repel(label= inshore_geno, nudge_x = 0.25) +
  facet_grid(~Treatment_f) +
  theme_bw() +
  theme(legend.position = "none") +
  ggtitle("P.ast Inshore FvFm: All Timepoints per Tank")

# Offshore Genotypes #
offshore <- Past_PAM_TP %>%
  filter(site == "offshore")

offshore_geno <- offshore$Genotype

offshore$Treatment_f = factor(offshore$Treatment, levels=c('Control','Low','Medium','High'))

ggplot(offshore, aes(x = TP_ID, y = FvFm, color = Genotype)) +
  geom_point() +
  ggrepel::geom_text_repel(label= offshore_geno, nudge_x = 0.25) +
  facet_grid(~Treatment_f) +
  theme_bw() +
  theme(legend.position = "none") +
  ggtitle("P.ast Offshore FvFm: All Timepoints per Tank")

# Each Genotype PAM Individually Plotted per Tank #
ggplot(inshore, aes(x = TP_ID, y = FvFm, color = Genotype)) +
  geom_point(size = 2) +
  facet_grid(Genotype~Treatment_f) +
  theme_bw() +
  theme(legend.position = "none") +
  xlab("Timepoint") +
  ggtitle("P.ast Inshore FvFm: All Timepoints per Tank")

ggplot(offshore, aes(x = TP_ID, y = FvFm, color = Genotype)) +
  geom_point() +
  facet_grid(Genotype~Treatment_f) +
  theme_bw() +
  theme(legend.position = "none") +
  xlab("Timepoint") +
  ggtitle("P.ast Offshore FvFm: All Timepoints per Tank")


# Each Genotype per Timepoint #
ggplot(inshore, aes(x = TP_ID, y = FvFm, color = Treatment)) +
  geom_point(size = 2) +
  facet_wrap(~Genotype) +
  theme_bw() +
  theme(legend.position = c(0.75,0.25)) +
  xlab("Timepoint") +
  ggtitle("P.ast Inshore FvFm: All Timepoints per Genotype")

ggplot(offshore, aes(x = TP_ID, y = FvFm, color = Treatment)) +
  geom_point(size = 2) +
  facet_wrap(~Genotype) +
  theme_bw() +
  theme(legend.position = c(0.75,0.25)) +
  xlab("Timepoint") +
  ggtitle("P.ast Offshore FvFm: All Timepoints per Genotype")

```

# Past Temperature vs FvFm at T3 Sampling Time  #
```{r}
Past_T3 <- PAST %>%
  filter(TubeNumber != "NA") %>%
  filter(TP_ID == "T3") %>%
  select(sample_ID, Geno, Treatment, Temperature, Timepoint, FvFm)

ggplot(Past_T3, aes(x = Temperature, y = FvFm, color = Geno)) +
  geom_point(size = 2) +
  facet_wrap(~Geno) +
  theme_bw() +
  theme(legend.position = "none") +
  xlab("Temperature") +
  ggtitle("P.ast FvFm across Temperature from T3 Samples")
```


##########################################################################
##### ACROPORA CERVICORNIS #####
##########################################################################

# ACER ED50s PER GENO PER TIMEPOINT #
```{r}
Acer_TP <- ACER %>%
  filter(TP_ID == "T1" | TP_ID == "T2" | TP_ID == "T3" | TP_ID == "T4" & Timepoint == "T4" | TP_ID == "T5" & Timepoint == "T5") %>%
  mutate(ID = paste(Geno,TP_ID))

Acer_TP_DRC <- drm(FvFm ~ Temperature, data = Acer_TP, curveid = ID,
             fct = LL.3(names = c('hill', 'max', 'ed50')))

summary(Acer_TP_DRC)
compParm(Acer_TP_DRC, 'ed50')
compParm(Acer_TP_DRC, 'ed50', "-")
plot(Acer_TP_DRC)

Acer_TP_ED <- ED(Acer_TP_DRC, c(50), interval = "delta")

Acer_ED_df <- as.data.frame(Acer_TP_ED) %>%
  setDT(keep.rownames = "Geno") %>%
  mutate(Genotype = case_when(grepl(":07", Geno) ~ "07",
                              grepl(":31", Geno) ~ "31",
                              grepl(":34", Geno) ~ "34",
                              grepl(":41", Geno) ~ "41",
                              grepl(":48", Geno) ~ "48",
                              grepl("e:50", Geno) ~ "50",
                              grepl(":62", Geno) ~ "62",
                              grepl(":CM5", Geno) ~ "CM5")) %>%
  mutate(TP_ID = case_when(grepl("T1", Geno)~ "T1",
                           grepl("T2", Geno)~ "T2",
                           grepl("T3", Geno)~ "T3",
                           grepl("T4", Geno)~ "T4",
                           grepl("T5", Geno)~ "T5")) %>%
select(-Geno, ED50 = Estimate) 

Acer_ED50_TP <- Acer_ED_df %>%
  select(Genotype, TP_ID, ED50)

Genotype <- Acer_ED50_TP$Genotype

ggplot(Acer_ED50_TP, aes(x = TP_ID, y = ED50, color = Genotype)) +
  geom_point() +
  ggrepel::geom_text_repel(label= Genotype, nudge_x = 0.05) +
  xlab("Timepoint") +
  theme_bw() +
  theme(legend.position = "none") +
  ggtitle("A.cer ED50s: All Timepoints")
  

ggsave(filename = "plots/Acer_Rank_ED50_all_TP_genofits.png", width = 174, height = 100, units = "mm")

```

# ACER PAM MEASUREMENT PLOTTING #
```{r}
ACER_PAM_TP <-  ACER %>%
  filter(TubeNumber != "NA") %>%
  select(Genotype = Geno, Treatment, Temperature, TP_ID, FvFm) %>%
  filter(Treatment != "Field", 
         Treatment != "Initial")

Genotype <- ACER_PAM_TP$Genotype 

ACER_PAM_TP$Treatment_f = factor(ACER_PAM_TP$Treatment, levels=c('Control','Low','Medium','High'))


ggplot(ACER_PAM_TP, aes(x = TP_ID, y = FvFm, color = Genotype)) +
  geom_point() +
  ggrepel::geom_text_repel(label= Genotype, nudge_x = 0.25) +
  facet_grid(~Treatment_f) +
  theme_bw() +
  theme(legend.position = "none") +
  ggtitle("A.cer FvFm: All Timepoints per Tank")

# Each Genotype PAM Individually Plotted per Tank #
ggplot(ACER_PAM_TP, aes(x = TP_ID, y = FvFm, color = Genotype)) +
  geom_point(size = 2) +
  facet_grid(Genotype~Treatment_f) +
  theme_bw() +
  theme(legend.position = "none") +
  xlab("Timepoint") +
  ggtitle("A.cer FvFm: All Timepoints per Tank")
  

# Each Genotype per Timepoint #
ggplot(ACER_PAM_TP, aes(x = TP_ID, y = FvFm, color = Treatment)) +
  geom_point(size = 2) +
  facet_wrap(~Genotype) +
  theme_bw() +
  theme(legend.position = c(0.75,0.25)) +
  xlab("Timepoint") +
  ggtitle("A.cer FvFm: All Timepoints per Genotype")

```

# Acer Temperature vs FvFm at T3 Sampling Time  #
```{r}
Acer_T3 <- ACER %>%
  filter(TubeNumber != "NA") %>%
  filter(TP_ID == "T3") %>%
  select(sample_ID, Geno, Treatment, Temperature, Timepoint, FvFm)

ggplot(Acer_T3, aes(x = Temperature, y = FvFm, color = Geno)) +
  geom_point() +
  facet_wrap(~Geno) +
  theme_bw() +
  theme(legend.position = "none") +
  xlab("Temperature") +
  ggtitle("A.cer FvFm: Across Temperature from T3 Samples")
```

# CALC ROSS DATA AS 4 TEMP EXPERIMENT #
```{r}
RossPam <- readxl::read_xlsx("data/PAM/Ross_Mote_Pam_Data.xlsx") %>%
  select(geno, FvFm = fvfm, Temp = target_temp) %>%
  mutate(FacTemp = as.factor(Temp))

  
Ross_df <- RossPam %>%
  filter(Temp == 37 | Temp == 35 | Temp == 33 | Temp == 30) %>%
  mutate(Geno = case_when(geno == "ML7" ~ "07",
                              geno == "ML31" ~ "31",
                              geno == "ML34" ~ "34",
                              geno == "ML41" ~ "41",
                              geno == "ML48" ~ "48",
                              geno == "ML50" ~ "50",
                              geno == "ML62" ~ "62")) %>%
  filter(Geno > 0) %>%
  group_by(Geno, Temp) %>%
  mutate(Genoavg = mean(FvFm)) %>%
  ungroup() %>%
  select(Geno, Temp, FacTemp, FvFm = Genoavg)

Ross_df <- unique(Ross_df)

Ross_df$Geno<-as.factor(Ross_df$Geno)
Ross_df$Temp<- as.integer(Ross_df$Temp)
Ross_df<-as.data.frame(Ross_df)


# Homoscedasticity/ Equal Variance Testing 
bartlett.test(FvFm ~ FacTemp, data=Ross_df)
leveneTest(FvFm ~ FacTemp, data=Ross_df)
aggregate(FvFm ~ FacTemp, data=Ross_df, FUN= function(x) shapiro.test(x)$p.value)

n1<-aov(FvFm ~ FacTemp + Error(Geno/FacTemp), Ross_df)
summary(n1)

print(lsmeans(n1, list(pairwise ~ FacTemp)), adjust = c("tukey"))

str(Ross_df)

# Full Curve Fit 
Ross_DRCpam = drm(FvFm ~ Temp, data = Ross_df,
                 fct = LL.3(names = c('hill', 'max', 'ed50')))
summary(Ross_DRCpam)
plot(Ross_DRCpam)

Ross_DRCpamgeno = drm(FvFm ~ Temp, data = Ross_df, curveid = Geno,
             fct = LL.3(names = c('hill', 'max', 'ed50')))
summary(Ross_DRCpamgeno)
compParm(Ross_DRCpamgeno, 'ed50')
compParm(Ross_DRCpamgeno, 'ed50', "-")
plot(Ross_DRCpamgeno)
ED(Ross_DRCpamgeno, c(50))[,1]

Ross_ED <- ED(Ross_DRCpamgeno, c(50), interval = "delta")

Ross_ED_df<- as.data.frame(Ross_ED) 

Ross_ED50 <- setDT(Ross_ED_df, keep.rownames = "Geno") %>%
  mutate(Genotype = case_when(grepl("e:07", Geno) ~ "07",
                              grepl("e:31", Geno) ~ "31",
                              grepl("e:34", Geno) ~ "34",
                              grepl("e:41", Geno) ~ "41",
                              grepl("e:48", Geno) ~ "48",
                              grepl("e:50", Geno) ~ "50",
                              grepl("e:62", Geno) ~ "62",
                              grepl("e:CM", Geno) ~ "CM5"))

Ross_ED50_geno <- Ross_ED50 %>%
  select(Genotype, ED50 = Estimate)
```

# CALC COURTNEY'S DATA AS 4 TEMP EXPERIMENT #
```{r}
CourtPam <- readxl::read_xlsx("data/PAM/Courtney_Mote_Pam_Data.xlsx") %>%
  select(Genotype, FvFm = Y, Temp) %>%
  mutate(FacTemp = as.factor(Temp))

CourtPam$FvFm<- as.numeric(CourtPam$FvFm)

  
Court_df <- CourtPam %>%
  filter(Temp == 37 | Temp == 34.4 | Temp == 32.9 | Temp == 30.2) %>%
  mutate(Geno = case_when(Genotype == "AC7" ~ "07",
                          Genotype == "AC31" ~ "31",
                          Genotype == "AC41" ~ "41",
                          Genotype == "AC50" ~ "50",
                          Genotype == "AC62" ~ "62")) %>%
  select(Geno, FacTemp, Temp, FvFm) %>%
  group_by(Geno, Temp) %>%
  mutate(Genoavg = mean(FvFm)) %>%
  ungroup() %>%
  select(Geno, Temp, FacTemp, FvFm = Genoavg) %>%
  filter(Geno > 0)


Court_df$Geno<-as.factor(Court_df$Geno)
Court_df$Temp<- as.integer(Court_df$Temp)
Court_df<-as.data.frame(Court_df)

str(Court_df)

# Homoscedasticity/ Equal Variance Testing 
bartlett.test(FvFm ~ FacTemp, data=Court_df)
leveneTest(FvFm ~ FacTemp, data=Court_df)
aggregate(FvFm ~ FacTemp, data=Court_df, FUN= function(x) shapiro.test(x)$p.value)

n1<-aov(FvFm ~ FacTemp + Error(Geno/FacTemp), Court_df)
summary(n1)

print(lsmeans(n1, list(pairwise ~ FacTemp)), adjust = c("tukey"))

# Full Curve Fit 
Court_DRCpam = drm(FvFm ~ Temp, data = Court_df,
                 fct = LL.3(names = c('hill', 'max', 'ed50')))
summary(Court_DRCpam)
plot(Court_DRCpam)

Court_DRCpamgeno = drm(FvFm ~ Temp, data = Court_df, curveid = Geno,
             fct = LL.3(names = c('hill', 'max', 'ed50')))
summary(Court_DRCpamgeno)
compParm(Court_DRCpamgeno, 'ed50')
compParm(Court_DRCpamgeno, 'ed50', "-")
plot(Court_DRCpamgeno)
ED(Court_DRCpamgeno, c(50))[,1]

Court_ED <- ED(Court_DRCpamgeno, c(50), interval = "delta")

Court_ED_df<- as.data.frame(Court_ED) 

Court_ED50 <- setDT(Court_ED_df, keep.rownames = "Geno") %>%
  mutate(Genotype = case_when(grepl("e:07", Geno) ~ "07",
                              grepl("e:31", Geno) ~ "31",
                              grepl("e:41", Geno) ~ "41",
                              grepl("e:50", Geno) ~ "50",
                              grepl("e:62", Geno) ~ "62"))

Court_ED50_geno <- Court_ED50 %>%
  select(Genotype, ED50 = Estimate)
```

# TRYING TO PLOT ED50 CURVES #
```{r}

# https://github.com/BarshisLab/CBASS-vs-RSS-Physiology/blob/main/Figures/Figure%204/Fig4_PAM_plotting.R

a <- Ross_df %>%
  mutate(run = "Ross") %>%
  select(Geno, Temp, FvFm, run)

b <- Court_df %>%
  mutate(run = "Courtney")%>%
  select(Geno, Temp, FvFm, run)

b <- unique(b)

c <- Acer_T3 %>%
  mutate(run = "Barshis") %>%
  select(Geno, Temp = Temperature, FvFm, run)

d <-rbind(a, b, c) %>%
  filter(Geno != "CM5") 

dose_resp <- y ~ min + ((max - min) / (1 + exp(hill_coefficient * (ec50 - x))))

ggplot(d, aes(x = Temp, y = FvFm, color = run)) +
  geom_point() +
  facet_wrap(~Geno) 


```

